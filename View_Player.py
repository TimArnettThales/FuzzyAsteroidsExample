from asteroids.fuzzy_asteroids import FuzzyAsteroidGame, TrainerEnvironment
from sample_controller_Lynn_12_13_for_GA import FuzzyController


def get_best_individual(population):
    def evaluate(individual):

        # Run a single game
        score = game.run(controller=FuzzyController(individual))
        accuracy = score.accuracy
        asteroids_hit = score.asteroids_hit
        final_measure = accuracy * asteroids_hit
        print('Fitness: ', final_measure)
        return final_measure

    best_fit = 0
    for individual in population:
        fitness = evaluate(individual)
        if fitness > best_fit:
            best_individual = individual

    return best_individual

#To use the controller within the context of a training solution
settings = {
    "lives": 1,
    "allow_key_presses": False
}
game = TrainerEnvironment(settings=settings)
pop = [[0.5017473659515097, 0.3615614841327486, 0.7356454221488796, 0.6016144492509516, 0.6344750157143537, 0.19638672086267084, 0.3976752540694384, 0.02937378630133769, 0.09184807124939143, 0.45234252397109, 0.29935761812186423, 0.9365299878465823, 0.6949873795268001, 0.898860273446574, 0.8626432325053668, 0.3355012568014636, 0.7291294876474492, 0.4258984138756363, 0.9699604756041418, 0.06463456265983825, 0.5030785536754424, 0.7856845000345847, 0.39176455083451267, 0.8904934384014745, 0.8031446200658373, 0.02095185557456436, 0.27755014241931275, 0.5939240560037451, 0.5446260199858773, 0.16818521167362643, 0.4335865886159923, 0.19154662189147964, 0.15161365588548636, 0.218210032862718, 0.25150409934721185, 0.8661786857284098, 0.6210904413312758, 0.24002187197940783, 0.5252889081678043, 0.3544915794135456, 0.5793889377017685, 0.4310629187973538, 0.4535888370759886, 0.5930919772264538, 0.19644121124499925, 0.34087469057497677, 0.38686368765901036, 0.7391258927705241, 0.0068869332350155466, 0.7179052425787263, 0.16769042937497192, 0.5481154389264834, 0.8511433833783861, 0.2365923485389363], [0.5017473659515097, 0.3615614841327486, 0.7356454221488796, 0.6016144492509516, 0.6344750157143537, 0.19638672086267084, 0.3976752540694384, 0.02937378630133769, 0.09184807124939143, 0.45234252397109, 0.29935761812186423, 0.9365299878465823, 0.6949873795268001, 0.898860273446574, 0.8626432325053668, 0.3355012568014636, 0.7291294876474492, 0.4258984138756363, 0.9699604756041418, 0.06463456265983825, 0.5030785536754424, 0.7856845000345847, 0.39176455083451267, 0.8904934384014745, 0.8031446200658373, 0.02095185557456436, 0.27755014241931275, 0.5939240560037451, 0.5446260199858773, 0.16818521167362643, 0.4335865886159923, 0.19154662189147964, 0.15161365588548636, 0.218210032862718, 0.25150409934721185, 0.8661786857284098, 0.6210904413312758, 0.24002187197940783, 0.5252889081678043, 0.3544915794135456, 0.5793889377017685, 0.4310629187973538, 0.4535888370759886, 0.5930919772264538, 0.19644121124499925, 0.34087469057497677, 0.38686368765901036, 0.7391258927705241, 0.0068869332350155466, 0.7179052425787263, 0.16769042937497192, 0.5481154389264834, 0.8511433833783861, 0.2365923485389363], [0.9084560301478399, 0.258299235990717, 0.7538022887648599, 0.1483265560410374, 0.7612478154176106, 0, 0.8981105011472663, 0.26952242755138145, 0.8074285949364514, 0.9469578284144726, 0.7668699625173424, 0.9950684798700137, 0.9529989410396645, 0.898860273446574, 0.8626432325053668, 0.3355012568014636, 0.7291294876474492, 0.8089837783658704, 0.5762364133538502, 0.138642764380285, 0.2034569887472485, 0.09756998677946294, 0.13372774877550808, 0.5081818629132152, 0.677637554335446, 0.6417669225971286, 0.6400065200588377, 0.3030918396637049, 0.3844748584222125, 0.28185169713125524, 0.3758584641958559, 0.14402922125632622, 0.14402300063980622, 0.26486054027783024, 0.2432871238586204, 0.8714530500744307, 0.06478987237921496, 0.46531998421915266, 0.9541640725170658, 0.6746210310564911, 0.0827488010348989, 0.009960870237636477, 0.11853354953217177, 0.3963105787985365, 0.04930511332997345, 0.920867186841228, 0.6387196834465195, 0.46818700502181376, 0.9154817725877571, 0.4673147271275694, 0.7560326270490088, 0.1021796518255208, 0, 0.25966640967401555], [0.5017473659515097, 0.3615614841327486, 0.7356454221488796, 0.6016144492509516, 0.6344750157143537, 0.19638672086267084, 0.3976752540694384, 0.02937378630133769, 0.09184807124939143, 0.45234252397109, 0.29935761812186423, 0.9365299878465823, 0.6949873795268001, 1, 0.9633647060816752, 0.25317533940696846, 0.37083450059989065, 0.8089837783658704, 0.5762364133538502, 0.41402618260065394, 0.7759707661700568, 0.18801337997767742, 0.540577994003405, 0.38497149875463965, 0.2114685762123738, 0.4198070253838976, 0.6252817334481588, 0.9721658494136725, 0.24672879849518348, 0.712438386765473, 0.06726239031278192, 0.23210810677334592, 0.647711613528918, 0.5497006376182372, 0.5452180470132221, 0.4991889228821883, 0.23413760663702654, 0.609417058910843, 0.1909198444500717, 0.6617961748455445, 0.6411409503662597, 0.9869349824195349, 0.545391707341682, 0.5396777126992206, 0.05715429771324099, 0.7328035774587968, 0.4315843821206876, 0.46818700502181376, 0.9154817725877571, 0.7179052425787263, 0.16769042937497192, 0.5481154389264834, 0.8511433833783861, 0.2365923485389363], [0.5017473659515097, 0.3615614841327486, 0.7356454221488796, 0.6016144492509516, 0.6344750157143537, 0.19638672086267084, 0.3976752540694384, 0.02937378630133769, 0.09184807124939143, 0.45234252397109, 0.29935761812186423, 0.9365299878465823, 0.6949873795268001, 0.898860273446574, 0.8626432325053668, 0.3355012568014636, 0.7291294876474492, 0.4258984138756363, 0.9699604756041418, 0.06463456265983825, 0.5030785536754424, 0.7856845000345847, 0.39176455083451267, 0.8904934384014745, 0.8031446200658373, 0.02095185557456436, 0.6252817334481588, 0.9721658494136725, 0.24672879849518348, 0.712438386765473, 0.06726239031278192, 0.23210810677334592, 0.647711613528918, 0.5497006376182372, 0.5452180470132221, 0.4991889228821883, 0.23413760663702654, 0.609417058910843, 0.5252889081678043, 0.3544915794135456, 0.5793889377017685, 0.4310629187973538, 0.4535888370759886, 0.5930919772264538, 0.19644121124499925, 0.34087469057497677, 0.38686368765901036, 0.7391258927705241, 0.0068869332350155466, 0.7179052425787263, 0.16769042937497192, 0.5481154389264834, 0.8511433833783861, 0.2365923485389363], [0.2892468317221726, 0.8577679237303867, 0.7753113793274818, 0.751535774508935, 0.5592760497682183, 0.47066134915250935, 0.4815698490030441, 0.28446671387017575, 0.46252038701352405, 0.48063683522865075, 0.4287655261253147, 0.5741436593607022, 0.2626335569651719, 0.7664569617818535, 0.9774611630069545, 0.6727155748900606, 0.624015405687585, 0.9102114744681311, 0.1161555064170029, 0.41402618260065394, 0.7759707661700568, 0.18801337997767742, 0.540577994003405, 0.38497149875463965, 0.2114685762123738, 0.4198070253838976, 0.27755014241931275, 0.5939240560037451, 0.5446260199858773, 0.16818521167362643, 0.4335865886159923, 0.19154662189147964, 0.15161365588548636, 0.218210032862718, 0.25150409934721185, 0.8661786857284098, 0.6210904413312758, 0.24002187197940783, 0.1909198444500717, 0.6617961748455445, 0.6411409503662597, 0.9869349824195349, 0.545391707341682, 0.5396777126992206, 0.05715429771324099, 0.7328035774587968, 0.6387196834465195, 0.7815699607339729, 0.10299838148090845, 0.36979861615832266, 0.05251857835197027, 0.8365464621296596, 0.1497270176609211, 0.02421871285652799], [0.5017473659515097, 0.3615614841327486, 0.7356454221488796, 0.6016144492509516, 0.6344750157143537, 0.19638672086267084, 0.3976752540694384, 0.02937378630133769, 0.09184807124939143, 0.45234252397109, 0.29935761812186423, 0.9365299878465823, 0.6949873795268001, 0.898860273446574, 0.8626432325053668, 0.3355012568014636, 0.7291294876474492, 0.4258984138756363, 0.9699604756041418, 0.06463456265983825, 0.5030785536754424, 0.7856845000345847, 0.39176455083451267, 0.8904934384014745, 0.8031446200658373, 0.02095185557456436, 0.27755014241931275, 0.5939240560037451, 0.5446260199858773, 0.16818521167362643, 0.4335865886159923, 0.19154662189147964, 0.15161365588548636, 0.218210032862718, 0.25150409934721185, 0.8661786857284098, 0.6210904413312758, 0.24002187197940783, 0.5252889081678043, 0.3544915794135456, 0.5793889377017685, 0.4310629187973538, 0.4535888370759886, 0.5930919772264538, 0.19644121124499925, 0.34087469057497677, 0.38686368765901036, 0.7391258927705241, 0.0068869332350155466, 0.7179052425787263, 0.16769042937497192, 0.5481154389264834, 0.8511433833783861, 0.2365923485389363], [0.12203968084966299, 0.09414112756527926, 0.14018091149600687, 0.4611594125498423, 0.4049786023084997, 0.32538496372343795, 1, 0.02937378630133769, 0.09184807124939143, 0.45234252397109, 0.29935761812186423, 0.24791212767118387, 0.9824923335790137, 0.5855424898475009, 0.5096364866830576, 0.20942044322780506, 0.7632829128045895, 0.13817637546767692, 0.9647634997598845, 0.5904441325158234, 0.6792660561799014, 0.6997305695229893, 0.8160377056937687, 0.20165517804096067, 0.7849554784588505, 0.6493943150130539, 0.874068059255184, 0.5598345520159651, 0.8346293350086591, 0.3170028821712402, 0.9678055043166458, 0.9004033153173824, 0.5745870296031301, 0.97064453184669, 0.892957029023571, 0.24741104765943467, 0, 0.10684759682407452, 0.7354467969197631, 0.8113357986804329, 0.7199730712770444, 0.4783040785825182, 0.459359925146711, 0.44157040511178536, 0.19644121124499925, 0.34087469057497677, 0.38686368765901036, 0.7391258927705241, 0.0068869332350155466, 0.8911450707597512, 0.3407088856090028, 0.8745612737851962, 0.9068610407217021, 0.13574022963599464], [0.5017473659515097, 0.3615614841327486, 0.7356454221488796, 0.6016144492509516, 0.6344750157143537, 0.19638672086267084, 0.3976752540694384, 0.02937378630133769, 0.09184807124939143, 0.45234252397109, 0.29935761812186423, 0.9365299878465823, 0.6949873795268001, 0.898860273446574, 0.8626432325053668, 0.3355012568014636, 0.7291294876474492, 0.8089837783658704, 0.5762364133538502, 0.138642764380285, 0.2034569887472485, 0.09756998677946294, 0.13372774877550808, 0.5081818629132152, 0.677637554335446, 0.6417669225971286, 0.6400065200588377, 0.3030918396637049, 0.3844748584222125, 0.28185169713125524, 0.3758584641958559, 0.14402922125632622, 0.14402300063980622, 0.26486054027783024, 0.2432871238586204, 0.8714530500744307, 0.06478987237921496, 0.46531998421915266, 0.9541640725170658, 0.6746210310564911, 0.0827488010348989, 0.009960870237636477, 0.11853354953217177, 0.3963105787985365, 0.04930511332997345, 0.920867186841228, 0.4315843821206876, 0.46818700502181376, 0.9154817725877571, 0.7179052425787263, 0.16769042937497192, 0.5481154389264834, 0.8511433833783861, 0.2365923485389363], [0.5017473659515097, 0.3615614841327486, 0.7356454221488796, 0.6016144492509516, 0.6344750157143537, 0.19638672086267084, 0.3976752540694384, 0.02937378630133769, 0.09184807124939143, 0.45234252397109, 0.29935761812186423, 0.9365299878465823, 0.6949873795268001, 0.898860273446574, 0.8626432325053668, 0.3355012568014636, 0.7291294876474492, 0.8089837783658704, 0.5762364133538502, 0.138642764380285, 0.2034569887472485, 0.09756998677946294, 0.13372774877550808, 0.5081818629132152, 0.677637554335446, 0.6417669225971286, 0.6400065200588377, 0.3030918396637049, 0.3844748584222125, 0.28185169713125524, 0.3758584641958559, 0.14402922125632622, 0.14402300063980622, 0.26486054027783024, 0.2432871238586204, 0.8714530500744307, 0.06478987237921496, 0.46531998421915266, 0.9541640725170658, 0.6746210310564911, 0.0827488010348989, 0.009960870237636477, 0.11853354953217177, 0.3963105787985365, 0.04930511332997345, 0.920867186841228, 0.4315843821206876, 0.46818700502181376, 0.9154817725877571, 0.7179052425787263, 0.16769042937497192, 0.5481154389264834, 0.8511433833783861, 0.2365923485389363]]

best_chromosome = get_best_individual(pop)
print(best_chromosome)

#max_fitness_over_time = [14.083333333333332, 14.083333333333332, 15.673469387755102]

best_chromosome = [0, 0, 0.22704675799038299, 0.18882866236303364, 1, 0.47358187053744416, 0, 1, 0.585630314551824, 0.790883187507398, 0.27213557586106574, 0, 0, 0, 0.9404657423334345, 1, 0, 0.5853468565829895, 0.6630343126200285, 0.20659052403638267, 0.8678535065106383, 0.07331896008842731, 1, 0, 1, 0.1019020994229195, 0.22845723584997757, 1, 0, 0, 0, 1, 0, 0.36694807573878296, 0.08019529514682067, 0.8204367511415689, 1, 1, 0.9538672228134206, 0.922668852048131, 0.05566674348341649, 0, 0.21565167263721652, 0, 0, 0, 1, 0, 1, 0, 0.01743356009048136, 1, 1, 1]


if __name__ == "__main__":
    # Available settings
    settings = {
        # "graphics_on": False,
        # "sound_on": True,
        # "frequency": 60,
        # "real_time_multiplier": 2,
        "lives": 3,
        # "prints": True,
        "allow_key_presses": False
    }

    """ Start the game """
    # Create a game instance

    # Instantiate the environment
    game = FuzzyAsteroidGame(settings=settings)
    score = game.run(controller=FuzzyController(best_chromosome))